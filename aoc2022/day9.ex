defmodule Day9 do
  def run do
    part1(input, {{{0,0},{0,0}}, %{{0,0} => true}})
  end

  def part1(moves, pTuple) do
    if length(moves) == 0 do
      IO.puts(length(Map.keys(elem(pTuple, 1))))
    else
      p = move(hd(moves), elem(pTuple, 0), elem(pTuple, 1))
      part1(tl(moves), p)
    end
  end

  def move(dir, poses, tPoses) do
    hPos = elem(poses, 0)
    tPos = elem(poses, 1)
    dirParts = String.split(dir, " ")
    moveNTimes(elem(Integer.parse(Enum.at(dirParts, 1)),0), Enum.at(dirParts, 0), poses, tPoses)
  end

  def moveNTimes(n, dir, poses, tPoses) do
    if n != 0 do
      nPos =moveSingle(dir, poses)
      nTPoses = Map.put(tPoses, elem(nPos, 1), true)
    #   IO.puts(dir)
    #   IO.puts(n)
    # IO.inspect(nPos)
    # IO.inspect(nTPoses)
      moveNTimes(n-1, dir, nPos, nTPoses)
    else
      {poses, tPoses}
    end
  end

  def moveSingle(dir, poses) do
    hPos = elem(poses, 0)
    tPos = elem(poses, 1)
    # IO.puts(dir)
    # IO.inspect(hPos)
    # IO.inspect(tPos)
    cond do
      dir == "R" ->
        nHpos = {elem(hPos, 0)+1,elem(hPos, 1)}
        {nHpos, newTpos(tPos, nHpos) }
      dir == "L" ->
        nHpos = {elem(hPos, 0)-1,elem(hPos, 1)}
        {nHpos, newTpos(tPos, nHpos) }
      dir == "U" ->
        nHpos = {elem(hPos, 0),elem(hPos, 1)+1}
        {nHpos, newTpos(tPos, nHpos) }
      dir == "D" ->
        nHpos = {elem(hPos, 0),elem(hPos, 1)-1}
        {nHpos, newTpos(tPos, nHpos) }
      true->
        "bad code"
    end
  end

  def newTpos(tPos, hPos) do
    xDiff = elem(tPos,0)-elem(hPos,0)
    yDiff = elem(tPos,1)-elem(hPos,1)
    cond do
      xDiff == yDiff && yDiff == 0 -> tPos
      xDiff == 0 && abs(yDiff) == 1 -> tPos
      yDiff == 0 && abs(xDiff) == 1 -> tPos
      abs(yDiff) == 1 && abs(xDiff) == 1 -> tPos
      yDiff == -2 -> {elem(hPos,0), elem(hPos,1)-1}
      yDiff == 2  -> {elem(hPos,0), elem(hPos,1)+1}
      xDiff == -2 -> {elem(hPos,0)-1, elem(hPos,1)}
      xDiff == 2  -> {elem(hPos,0)+1, elem(hPos,1)}
    end
  end

  def addTPos(pos, tPoses) do
    Map.put(tPoses, pos, true)
  end

  def inputEX do
    [
      "R 4",
      "U 4",
      "L 3",
      "D 1",
      "R 4",
      "D 1",
      "L 5",
      "R 2",
    ]
  end

  def input do
    ["R 2","D 2","R 2","U 1","R 2","L 2","D 1","L 1","D 2","R 2","U 2","D 1","R 2","D 2","U 1","R 1","D 1","L 1","U 1","R 1","L 1","R 2","U 2","D 2","R 2","L 2","U 1","L 2","U 2","L 2","R 2","U 2","R 1","U 2","L 2","D 1","R 1","U 2","D 2","R 2","L 2","U 1","D 1","L 2","U 2","L 2","U 1","D 2","R 1","D 1","R 2","U 1","L 2","D 1","U 2","R 2","L 1","D 2","U 1","D 1","L 1","U 1","R 1","D 1","R 1","U 1","D 2","L 1","D 1","R 2","D 1","U 2","D 2","U 2","L 1","U 2","R 2","L 2","D 2","R 1","L 2","U 2","L 1","U 1","L 1","R 2","L 2","R 1","D 1","U 1","L 2","R 1","L 1","U 1","D 1","U 1","D 1","R 1","L 2","R 2","L 1","U 1","D 2","U 2","L 2","R 2","U 1","R 2","L 2","R 2","L 1","U 3","D 1","L 1","D 3","U 1","D 2","L 1","R 3","D 2","U 3","R 1","D 3","R 2","D 1","U 3","L 1","R 2","L 3","D 3","U 2","L 2","R 3","U 3","D 3","L 3","D 2","L 3","R 1","L 1","D 1","U 3","D 3","U 2","L 3","R 3","U 1","D 2","R 2","L 2","D 3","R 3","U 1","R 1","L 3","U 2","L 2","U 1","R 1","D 1","R 3","U 2","D 1","L 1","U 1","R 2","L 1","R 3","L 1","U 3","L 2","D 2","L 2","D 3","L 2","R 1","U 2","L 3","D 1","L 3","D 1","U 2","L 3","R 2","U 1","L 3","D 3","R 3","U 2","R 2","D 3","R 3","U 2","R 2","L 2","U 3","R 1","L 2","D 3","U 1","L 1","U 1","L 2","R 3","L 3","D 3","R 3","U 3","L 1","R 2","D 3","U 1","R 2","U 1","D 1","L 1","D 2","L 2","D 3","U 2","D 1","U 3","D 3","U 3","R 3","L 3","U 4","L 3","D 1","R 4","U 3","D 2","R 1","D 4","L 3","U 1","L 1","R 2","D 1","R 3","D 3","L 3","D 4","L 3","R 4","U 3","R 3","D 1","R 3","D 3","R 3","D 4","U 4","R 2","D 3","R 3","D 2","U 1","R 2","D 2","U 2","D 3","L 2","R 4","D 4","U 4","R 3","U 4","R 1","U 2","R 4","D 2","L 4","R 4","U 3","L 2","U 2","L 3","R 3","L 1","U 4","L 3","U 3","L 3","U 1","R 2","U 3","R 2","L 3","U 1","D 3","R 4","D 1","R 2","L 1","D 1","U 2","D 3","R 4","U 1","L 3","R 4","U 4","L 4","R 2","D 1","U 4","R 1","D 3","L 3","D 1","R 3","D 2","U 2","L 1","U 2","D 3","L 1","U 3","D 3","L 3","U 2","L 3","U 2","R 1","D 1","R 1","L 1","D 2","R 3","D 2","L 2","R 3","D 5","R 5","U 4","D 5","U 5","D 4","R 4","D 2","R 5","L 4","R 2","L 2","R 5","U 5","R 1","D 2","R 1","L 3","D 5","U 3","D 4","R 3","U 4","D 1","U 4","L 5","R 1","U 4","L 5","U 3","D 4","L 2","D 4","U 4","L 2","D 1","R 3","D 1","R 2","D 4","R 5","L 1","U 4","L 4","U 3","L 1","U 1","R 4","U 3","L 1","R 3","D 5","U 2","R 4","D 3","L 2","D 4","R 5","D 2","U 3","R 4","D 4","L 2","U 4","R 5","L 1","U 5","D 1","R 3","L 4","D 1","U 3","D 5","R 2","D 2","L 5","U 2","D 3","L 5","D 5","L 1","R 5","D 2","U 3","R 2","L 2","U 1","L 5","R 1","L 4","D 5","R 5","D 2","U 5","L 5","D 1","L 1","D 3","R 1","D 2","L 2","R 4","U 5","L 2","R 1","U 3","D 1","U 1","D 5","R 2","D 2","R 3","D 6","U 1","R 6","D 4","U 1","R 5","L 6","R 2","L 6","U 6","R 5","D 2","U 1","D 2","L 2","D 5","R 3","U 4","D 2","L 1","U 1","D 3","U 1","D 1","R 5","U 1","R 1","D 3","U 5","L 6","R 3","L 6","U 4","D 2","R 1","L 6","R 2","D 3","U 2","R 2","L 1","D 1","U 1","R 4","U 1","R 2","U 2","L 2","U 2","D 5","L 4","U 6","L 3","D 6","U 5","L 6","U 3","R 5","U 2","R 4","L 6","D 1","R 5","D 4","L 2","R 2","U 1","D 2","L 2","U 4","R 1","D 2","U 2","R 6","L 2","D 5","R 5","L 3","D 1","U 1","L 2","D 4","R 6","L 5","R 3","U 1","R 3","L 1","R 3","U 1","L 1","U 4","D 4","U 3","R 3","U 1","R 2","D 1","L 6","U 2","R 2","D 1","R 5","L 2","D 5","L 3","R 6","D 2","L 2","D 3","L 5","D 7","L 7","D 4","U 5","R 7","L 7","D 3","U 5","R 6","U 3","L 6","R 5","L 4","D 4","R 4","L 6","D 6","U 3","D 3","R 7","U 1","L 5","U 3","L 4","U 3","L 5","D 1","R 7","U 3","L 6","D 1","U 3","L 2","U 6","L 6","D 1","U 1","D 2","L 5","U 4","R 5","D 7","U 3","D 4","L 1","D 3","R 7","D 2","U 4","L 1","D 3","R 3","D 6","R 4","U 3","D 4","R 6","L 7","U 5","L 7","R 3","L 7","D 5","R 7","D 4","U 3","R 6","U 7","D 2","R 2","L 2","D 1","R 3","U 3","D 5","U 3","L 3","D 6","L 6","R 1","L 5","D 6","U 4","R 2","L 2","D 1","U 7","L 5","D 3","U 1","L 1","R 1","L 6","R 1","D 6","U 4","L 7","U 6","R 6","L 2","D 5","R 1","D 6","L 1","R 3","D 1","U 5","L 1","D 3","U 7","D 5","U 7","D 7","U 4","R 3","U 4","L 8","U 1","R 1","D 2","U 5","D 2","L 5","D 6","U 4","R 5","L 5","U 7","L 3","D 1","L 2","R 8","L 1","U 8","L 2","D 3","R 6","L 8","D 2","L 1","U 4","D 1","R 2","D 7","U 5","D 4","U 4","L 2","D 6","U 1","D 5","U 2","D 2","L 8","D 6","L 2","U 1","R 7","D 1","U 5","L 6","D 3","L 2","D 8","R 6","L 5","U 2","L 6","U 4","D 6","L 7","U 8","L 5","D 8","R 8","D 6","L 3","U 6","L 1","D 8","R 7","L 7","R 2","D 6","R 1","U 5","L 5","R 5","L 3","U 8","L 1","U 2","D 5","R 8","U 5","L 5","D 2","R 5","U 1","D 8","R 3","U 1","R 6","D 6","R 5","D 6","L 8","U 8","L 8","U 8","L 8","R 8","U 8","R 5","L 1","D 3","U 1","D 6","U 1","L 8","U 3","R 5","L 2","R 1","D 2","L 2","U 4","D 1","R 1","D 2","R 2","U 4","R 3","U 8","D 9","L 9","D 5","L 4","D 7","L 9","U 4","L 9","D 7","U 4","L 3","U 2","R 5","U 3","L 1","R 5","L 8","U 4","R 6","L 8","U 1","R 7","D 6","R 6","U 7","L 9","R 7","U 8","R 5","U 6","L 4","D 4","L 3","R 8","U 6","L 7","R 4","D 7","R 3","L 3","D 2","L 2","U 5","R 8","L 7","R 9","D 8","U 1","L 1","D 4","U 6","R 4","L 2","R 9","L 9","R 2","D 3","L 4","U 6","R 3","D 5","L 4","R 8","U 3","R 5","L 3","D 7","R 1","D 2","U 5","L 7","D 6","R 1","D 9","L 9","R 8","U 8","L 8","D 7","U 3","L 2","U 4","D 8","U 6","R 3","U 5","R 7","D 1","R 8","L 9","U 7","D 9","L 2","R 7","U 1","R 6","D 3","L 5","U 10","L 8","R 3","L 4","D 9","U 4","L 5","U 5","D 10","R 8","U 6","L 3","U 4","D 6","L 8","D 2","R 8","L 9","U 3","R 5","D 1","R 9","D 6","L 5","R 10","L 8","R 9","L 6","U 8","L 8","U 5","R 3","U 6","D 3","L 10","D 9","U 5","L 3","U 6","R 2","D 7","R 9","L 5","D 3","U 3","R 2","D 10","U 3","R 2","U 6","L 10","R 3","U 3","R 4","L 8","R 1","L 6","U 9","L 7","D 7","R 6","U 3","R 1","L 6","D 5","L 3","U 2","L 5","R 9","D 5","R 4","L 2","U 5","D 7","L 10","D 9","U 7","D 9","R 5","D 3","L 1","R 10","L 4","U 6","R 7","L 2","R 6","L 3","R 3","D 2","L 1","R 2","L 7","D 8","R 5","L 7","D 8","U 5","L 8","U 4","R 8","U 1","D 1","U 4","D 6","R 8","U 10","D 5","U 5","L 1","D 2","R 10","U 10","R 2","L 9","R 2","D 3","L 6","R 10","D 10","R 9","D 7","U 3","R 4","D 9","R 4","D 9","U 9","L 8","D 7","R 7","U 7","R 7","D 9","L 7","U 5","L 10","R 8","L 11","D 9","L 5","R 11","L 6","R 1","U 2","D 9","L 3","R 6","L 6","R 2","L 6","D 6","R 2","D 5","L 8","R 9","U 6","D 6","L 1","R 3","D 2","R 5","D 6","L 1","D 10","U 2","R 4","U 6","R 11","D 1","R 2","L 4","D 9","L 4","U 8","D 10","U 4","R 10","D 1","U 11","R 2","L 11","D 7","U 1","L 7","U 10","D 10","L 11","R 1","U 8","R 1","L 11","R 3","D 10","R 10","L 9","U 7","R 9","L 6","R 7","U 5","R 6","U 4","L 11","U 7","R 7","L 4","U 4","R 2","D 3","R 2","L 9","D 4","L 11","R 6","D 2","L 9","R 7","D 6","U 5","L 8","D 9","R 11","U 11","R 6","D 11","L 9","R 4","L 6","U 10","R 11","U 5","L 6","R 12","D 3","R 4","U 12","R 6","D 8","R 1","D 2","L 11","R 6","D 5","U 10","D 5","R 8","L 6","D 5","U 5","R 8","L 1","D 10","R 5","U 6","L 8","R 4","L 10","D 6","R 3","D 9","L 4","R 9","U 5","R 2","U 11","R 9","U 8","R 7","L 2","D 7","U 7","D 8","U 12","R 6","D 12","R 5","D 10","U 2","D 8","U 6","R 3","U 5","R 5","L 11","D 10","R 3","U 11","D 8","R 7","L 3","U 9","R 4","L 2","D 4","R 8","D 9","R 2","D 3","U 6","L 5","D 4","L 2","R 9","U 5","D 1","U 9","R 9","U 11","L 12","R 10","D 5","U 1","R 9","U 4","D 8","R 1","D 5","R 7","U 11","L 6","U 1","R 12","D 1","R 7","U 12","D 9","R 12","L 1","U 3","D 6","R 11","L 6","U 8","D 11","R 7","U 5","D 4","U 1","L 11","D 1","U 5","R 13","L 9","U 4","D 4","R 10","U 4","D 7","L 4","D 10","R 6","D 5","R 9","L 10","D 2","U 11","D 8","U 1","R 8","U 5","R 8","D 10","L 10","D 7","R 5","U 6","D 7","U 9","R 8","D 4","R 2","D 1","L 1","U 2","R 10","D 2","U 13","L 9","U 13","L 12","U 12","D 6","L 1","R 4","L 7","R 4","L 2","U 8","R 7","D 10","U 2","L 8","D 5","R 9","D 9","R 2","L 3","U 2","D 11","U 5","D 12","R 3","U 10","D 2","R 1","D 13","U 7","L 7","R 1","U 1","R 1","U 6","D 12","R 7","L 7","R 9","U 10","R 13","D 3","R 12","U 1","L 6","R 9","U 10","L 1","U 13","R 2","D 8","U 12","D 10","L 7","U 6","D 9","L 11","D 8","U 4","R 1","D 11","L 8","U 1","D 4","R 7","U 7","R 5","L 1","R 14","L 8","D 10","R 13","U 13","R 9","L 13","U 2","D 7","R 11","D 2","L 9","D 11","L 2","U 12","D 11","R 12","D 3","R 6","L 11","R 7","D 3","U 6","D 9","L 10","R 13","D 7","U 14","L 10","R 11","D 12","R 12","U 13","R 4","L 14","U 5","L 4","U 10","L 3","U 13","R 9","D 7","U 8","R 5","L 14","U 5","R 6","D 13","L 13","U 9","R 13","D 1","L 8","R 9","U 8","L 7","U 4","D 4","R 4","L 5","U 11","R 14","L 2","U 1","D 14","R 13","D 3","L 13","D 2","U 9","D 14","U 1","R 1","D 12","L 6","R 4","U 4","L 11","U 14","D 13","R 12","L 7","U 13","R 4","U 14","L 14","R 11","L 8","D 3","U 4","R 1","U 5","D 12","L 5","U 14","D 6","R 6","U 4","L 1","D 11","U 9","R 5","U 13","D 7","L 5","D 3","L 8","U 7","D 4","L 13","R 1","D 11","L 7","U 6","D 9","R 10","D 6","R 9","L 2","D 6","U 12","L 10","D 3","U 6","L 4","R 4","U 12","D 13","R 9","L 1","R 5","U 14","R 14","D 7","U 10","R 3","L 4","U 6","L 13","U 14","R 10","L 7","D 12","U 5","L 11","D 7","U 9","D 4","L 1","R 11","D 9","L 5","D 15","R 4","U 12","L 1","U 8","L 15","D 15","L 3","R 11","L 9","R 1","U 12","D 9","R 7","D 6","U 2","L 12","U 13","R 11","L 15","D 4","L 8","U 6","L 7","R 2","U 7","D 2","U 13","D 10","L 13","U 1","D 6","L 11","R 14","L 5","U 2","R 11","D 10","L 4","R 14","U 13","D 9","U 2","D 4","R 14","L 4","R 4","L 4","U 6","D 11","L 10","U 9","L 3","U 12","L 8","U 9","D 4","U 4","L 10","U 1","D 8","U 15","D 3","U 12","R 3","D 8","U 1","R 10","L 1","U 5","D 1","L 1","R 3","U 1","R 8","U 10","R 1","U 11","R 15","D 16","U 13","D 7","U 7","D 14","R 9","L 13","R 12","U 2","R 11","L 11","R 3","D 11","U 11","R 2","D 3","U 6","L 14","R 6","L 6","U 3","R 3","D 1","U 5","L 3","R 4","D 9","U 15","R 2","U 5","D 5","R 14","U 6","R 1","D 4","U 2","D 3","R 8","L 4","D 2","U 12","D 2","U 7","L 14","U 1","R 10","L 4","D 12","L 9","D 16","U 2","R 7","D 16","U 9","D 13","U 7","L 14","D 5","R 12","U 13","R 13","U 2","L 11","D 9","U 2","R 8","U 5","R 7","U 9","L 11","D 16","U 10","R 5","D 7","L 6","D 8","U 4","R 3","D 5","L 5","U 11","R 4","D 12","R 12","L 10","R 15","U 9","D 12","L 11","U 6","D 11","U 12","L 6","R 3","U 12","D 5","L 1","R 12","U 14","L 1","D 2","L 4","D 7","L 12","U 10","L 12","U 4","D 14","R 13","U 9","L 2","U 6","L 1","U 9","D 16","L 2","R 16","D 5","L 7","U 13","L 15","R 1","D 8","R 15","D 5","R 12","L 5","R 11","U 17","D 13","U 13","L 4","D 8","L 1","D 7","R 11","U 7","R 11","L 9","D 3","L 2","U 4","D 16","L 10","U 11","R 5","U 4","R 6","L 11","R 17","U 13","R 12","D 11","L 17","U 15","D 4","R 9","U 9","L 10","D 5","R 14","U 10","R 5","U 15","L 12","D 14","R 14","L 11","R 5","U 7","D 1","R 4","D 14","U 3","R 6","D 5","R 1","D 12","L 14","D 6","L 15","U 16","D 10","R 12","D 9","U 1","D 1","L 4","D 6","U 16","R 11","L 11","R 3","L 2","U 12","R 9","D 16","R 12","L 14","U 6","L 7","D 5","U 4","R 13","L 8","D 16","U 5","D 5","U 6","R 14","L 6","D 7","U 3","L 15","R 14","L 17","R 17","U 16","L 4","R 3","U 1","D 15","L 12","D 11","L 18","D 18","U 10","D 4","U 1","R 11","U 18","D 12","R 11","U 13","D 14","R 17","D 18","U 13","R 8","U 4","R 9","D 18","L 6","R 7","L 14","U 10","L 10","U 16","D 15","L 15","D 3","L 2","D 7","R 3","D 7","U 11","L 6","R 8","L 3","U 3","R 8","D 8","U 10","L 15","D 1","U 16","R 1","L 13","R 7","U 10","L 12","R 8","D 3","L 14","D 12","R 12","D 3","L 2","D 15","R 3","L 14","D 4","R 5","L 13","D 9","U 2","L 5","R 13","D 4","L 14","R 14","D 16","R 1","U 11","R 6","L 7","U 16","L 15","D 6","U 7","R 16","D 2","L 15","D 18","U 3","D 1","R 7","D 1","L 4","D 16","U 12","L 12","R 7","U 5","L 5","U 13","R 13","U 7","L 9","R 9","U 8","D 6","L 3","U 4","R 12","L 12","D 16","U 12","L 4","R 11","U 9","D 13","R 15","L 3","D 17","R 6","D 13","R 6","D 5","L 19","U 10","D 3","L 2","U 13","R 2","D 3","L 3","U 3","R 1","U 12","L 2","D 19","L 17","R 10","D 11","U 8","R 10","L 15","R 4","D 9","U 4","D 11","U 4","D 3","L 5","D 15","U 1","L 19","D 16","R 11","U 12","D 16","L 4","R 13","U 2","L 19","U 9","R 5","D 7","R 19","L 9","U 2","D 2","R 3","U 10","L 13","D 16","L 2","D 5","L 8","R 9","L 18","R 9","U 13","D 7","R 14","U 8","R 18","L 18","U 8","L 13","R 9","U 5","L 16","U 4","D 4","R 10","U 13","R 2","L 6","R 18","D 3","L 11","R 12","L 2","R 12","D 7","U 12","R 13","U 14","D 1","R 8","L 13","U 5","L 9","U 19","D 14","L 4","U 8","D 8","U 1","D 16","U 4","D 8","U 20",]
  end
end

Day9.run()
